{"version":3,"file":"tobii.mjs","sources":["../src/js/index.js"],"sourcesContent":["/**\n * Tobii\n *\n * @author midzer\n * @version 2.0.7\n * @url https://github.com/midzer/tobii\n *\n * MIT License\n */\nexport default function Tobii (userOptions) {\n  /**\n   * Global variables\n   *\n   */\n  const FOCUSABLE_ELEMENTS = [\n    'a[href]:not([tabindex^=\"-\"]):not([inert])',\n    'area[href]:not([tabindex^=\"-\"]):not([inert])',\n    'input:not([disabled]):not([inert])',\n    'select:not([disabled]):not([inert])',\n    'textarea:not([disabled]):not([inert])',\n    'button:not([disabled]):not([inert])',\n    'iframe:not([tabindex^=\"-\"]):not([inert])',\n    'audio:not([tabindex^=\"-\"]):not([inert])',\n    'video:not([tabindex^=\"-\"]):not([inert])',\n    '[contenteditable]:not([tabindex^=\"-\"]):not([inert])',\n    '[tabindex]:not([tabindex^=\"-\"]):not([inert])'\n  ]\n  const WAITING_ELS = []\n  const GROUP_ATTS = {\n    gallery: [],\n    slider: null,\n    sliderElements: [],\n    elementsLength: 0,\n    currentIndex: 0,\n    x: 0\n  }\n  const PLAYER = []\n\n  let config = {}\n  let figcaptionId = 0\n  let lightbox = null\n  let prevButton = null\n  let nextButton = null\n  let closeButton = null\n  let counter = null\n  let drag = {}\n  let isDraggingX = false\n  let isDraggingY = false\n  let pointerDown = false\n  let lastFocus = null\n  let offset = null\n  let offsetTmp = null\n  let resizeTicking = false\n  let isYouTubeDependencieLoaded = false\n  let playerId = 0\n  let groups = {}\n  let newGroup = null\n  let activeGroup = null\n\n  /**\n   * Merge default options with user options\n   *\n   * @param {Object} userOptions - Optional user options\n   * @returns {Object} - Custom options\n   */\n  const mergeOptions = (userOptions) => {\n    // Default options\n    const OPTIONS = {\n      selector: '.lightbox',\n      captions: true,\n      captionsSelector: 'img',\n      captionAttribute: 'alt',\n      captionText: null,\n      nav: 'auto',\n      navText: [\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path stroke=\"none\" d=\"M0 0h24v24H0z\"/><polyline points=\"15 6 9 12 15 18\" /></svg>',\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path stroke=\"none\" d=\"M0 0h24v24H0z\"/><polyline points=\"9 6 15 12 9 18\" /></svg>'\n      ],\n      navLabel: [\n        'Previous image',\n        'Next image'\n      ],\n      close: true,\n      closeText: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path stroke=\"none\" d=\"M0 0h24v24H0z\"/><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" /><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" /></svg>',\n      closeLabel: 'Close lightbox',\n      loadingIndicatorLabel: 'Image loading',\n      counter: true,\n      download: false, // TODO\n      downloadText: '', // TODO\n      downloadLabel: 'Download image', // TODO\n      keyboard: true,\n      zoom: true,\n      zoomText: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path stroke=\"none\" d=\"M0 0h24v24H0z\"/><polyline points=\"16 4 20 4 20 8\" /><line x1=\"14\" y1=\"10\" x2=\"20\" y2=\"4\" /><polyline points=\"8 20 4 20 4 16\" /><line x1=\"4\" y1=\"20\" x2=\"10\" y2=\"14\" /><polyline points=\"16 20 20 20 20 16\" /><line x1=\"14\" y1=\"14\" x2=\"20\" y2=\"20\" /><polyline points=\"8 4 4 4 4 8\" /><line x1=\"4\" y1=\"4\" x2=\"10\" y2=\"10\" /></svg>',\n      docClose: true,\n      swipeClose: true,\n      hideScrollbar: true,\n      draggable: true,\n      threshold: 100,\n      rtl: false, // TODO\n      loop: false, // TODO\n      autoplayVideo: false,\n      modal: false,\n      theme: 'tobii--theme-default'\n    }\n\n    return {\n      ...OPTIONS, ...userOptions\n    }\n  }\n\n  /**\n   * Types - you can add new type to support something new\n   *\n   */\n  const SUPPORTED_ELEMENTS = {\n    image: {\n      checkSupport (el) {\n        return !el.hasAttribute('data-type') && el.href.match(/\\.(png|jpe?g|tiff|tif|gif|bmp|webp|avif|svg|ico)(\\?.*)?$/i)\n      },\n\n      init (el, container) {\n        const FIGURE = document.createElement('figure')\n        const FIGCAPTION = document.createElement('figcaption')\n        const IMAGE = document.createElement('img')\n        const THUMBNAIL = el.querySelector('img')\n        const LOADING_INDICATOR = document.createElement('div')\n\n        // Hide figure until the image is loaded\n        FIGURE.style.opacity = '0'\n\n        if (THUMBNAIL) {\n          IMAGE.alt = THUMBNAIL.alt || ''\n        }\n\n        IMAGE.setAttribute('src', '')\n        IMAGE.setAttribute('data-src', el.href)\n\n        if (el.hasAttribute('data-srcset')) {\n          IMAGE.setAttribute('srcset', el.getAttribute('data-srcset'))\n        }\n\n        // Add image to figure\n        FIGURE.appendChild(IMAGE)\n\n        // Create figcaption\n        if (config.captions) {\n          if (typeof config.captionText === 'function') {\n            FIGCAPTION.textContent = config.captionText(el)\n          } else if (config.captionsSelector === 'self' && el.getAttribute(config.captionAttribute)) {\n            FIGCAPTION.textContent = el.getAttribute(config.captionAttribute)\n          } else if (config.captionsSelector === 'img' && THUMBNAIL && THUMBNAIL.getAttribute(config.captionAttribute)) {\n            FIGCAPTION.textContent = THUMBNAIL.getAttribute(config.captionAttribute)\n          }\n\n          if (FIGCAPTION.textContent) {\n            FIGCAPTION.id = `tobii-figcaption-${figcaptionId}`\n            FIGURE.appendChild(FIGCAPTION)\n\n            IMAGE.setAttribute('aria-labelledby', FIGCAPTION.id)\n\n            ++figcaptionId\n          }\n        }\n\n        // Add figure to container\n        container.appendChild(FIGURE)\n\n        // Create loading indicator\n        LOADING_INDICATOR.className = 'tobii__loader'\n        LOADING_INDICATOR.setAttribute('role', 'progressbar')\n        LOADING_INDICATOR.setAttribute('aria-label', config.loadingIndicatorLabel)\n\n        // Add loading indicator to container\n        container.appendChild(LOADING_INDICATOR)\n\n        // Register type\n        container.setAttribute('data-type', 'image')\n        container.classList.add('tobii-image')\n      },\n\n      onPreload (container) {\n        // Same as preload\n        SUPPORTED_ELEMENTS.image.onLoad(container)\n      },\n\n      onLoad (container) {\n        const IMAGE = container.querySelector('img')\n\n        if (!IMAGE.hasAttribute('data-src')) {\n          return\n        }\n\n        const FIGURE = container.querySelector('figure')\n        const LOADING_INDICATOR = container.querySelector('.tobii__loader')\n\n        IMAGE.onload = () => {\n          container.removeChild(LOADING_INDICATOR)\n          FIGURE.style.opacity = '1'\n        }\n\n        IMAGE.setAttribute('src', IMAGE.getAttribute('data-src'))\n        IMAGE.removeAttribute('data-src')\n      },\n\n      onLeave (container) {\n        // Nothing\n      },\n\n      onCleanup (container) {\n        // Nothing\n      }\n    },\n\n    html: {\n      checkSupport (el) {\n        return checkType(el, 'html')\n      },\n\n      init (el, container) {\n        const TARGET_SELECTOR = el.hasAttribute('data-target') ? el.getAttribute('data-target') : el.getAttribute('href')\n        const TARGET = document.querySelector(TARGET_SELECTOR)\n\n        if (!TARGET) {\n          throw new Error(`Ups, I can't find the target ${TARGET_SELECTOR}.`)\n        }\n\n        // Add content to container\n        container.appendChild(TARGET)\n\n        // Register type\n        container.setAttribute('data-type', 'html')\n        container.classList.add('tobii-html')\n      },\n\n      onPreload (container) {\n        // Nothing\n      },\n\n      onLoad (container) {\n        const VIDEO = container.querySelector('video')\n\n        if (VIDEO) {\n          if (VIDEO.hasAttribute('data-time') && VIDEO.readyState > 0) {\n            // Continue where video was stopped\n            VIDEO.currentTime = VIDEO.getAttribute('data-time')\n          }\n\n          if (config.autoplayVideo) {\n            // Start playback (and loading if necessary)\n            VIDEO.play()\n          }\n        }\n      },\n\n      onLeave (container) {\n        const VIDEO = container.querySelector('video')\n\n        if (VIDEO) {\n          if (!VIDEO.paused) {\n            // Stop if video is playing\n            VIDEO.pause()\n          }\n\n          // Backup currentTime (needed for revisit)\n          if (VIDEO.readyState > 0) {\n            VIDEO.setAttribute('data-time', VIDEO.currentTime)\n          }\n        }\n      },\n\n      onCleanup (container) {\n        const VIDEO = container.querySelector('video')\n\n        if (VIDEO) {\n          if (VIDEO.readyState > 0 && VIDEO.readyState < 3 && VIDEO.duration !== VIDEO.currentTime) {\n            // Some data has been loaded but not the whole package.\n            // In order to save bandwidth, stop downloading as soon as possible.\n            const VIDEO_CLONE = VIDEO.cloneNode(true)\n\n            removeSources(VIDEO)\n            VIDEO.load()\n\n            VIDEO.parentNode.removeChild(VIDEO)\n\n            container.appendChild(VIDEO_CLONE)\n          }\n        }\n      }\n    },\n\n    iframe: {\n      checkSupport (el) {\n        return checkType(el, 'iframe')\n      },\n\n      init (el, container) {\n        const IFRAME = document.createElement('iframe')\n        const HREF = el.hasAttribute('data-target') ? el.getAttribute('data-target') : el.getAttribute('href')\n\n        IFRAME.setAttribute('frameborder', '0')\n        IFRAME.setAttribute('src', '')\n        IFRAME.setAttribute('allowfullscreen', '')\n        IFRAME.setAttribute('data-src', HREF)\n\n        // Hide until loaded\n        IFRAME.style.opacity = '0'\n\n        // set allow parameters\n        if (HREF.indexOf('youtube.com') > -1) {\n          IFRAME.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture')\n        } else if (HREF.indexOf('vimeo.com') > -1) {\n          IFRAME.setAttribute('allow', 'autoplay; picture-in-picture')\n        } else if (el.hasAttribute('data-allow')) {\n          IFRAME.setAttribute('allow', el.getAttribute('data-allow'))\n        }\n\n        if (el.getAttribute('data-width')) {\n          IFRAME.style.maxWidth = `${el.getAttribute('data-width')}px`\n        }\n\n        if (el.getAttribute('data-height')) {\n          IFRAME.style.maxHeight = `${el.getAttribute('data-height')}px`\n        }\n\n        // Add iframe to container\n        container.appendChild(IFRAME)\n\n        // Register type\n        container.setAttribute('data-type', 'iframe')\n        container.classList.add('tobii-iframe')\n      },\n\n      onPreload (container) {\n        // Nothing\n      },\n\n      onLoad (container) {\n        const IFRAME = container.querySelector('iframe')\n        IFRAME.setAttribute('src', IFRAME.getAttribute('data-src'))\n\n        IFRAME.onload = () => {\n          IFRAME.style.opacity = '1'\n        }\n      },\n\n      onLeave (container) {\n        // Nothing\n      },\n\n      onCleanup (container) {\n        const IFRAME = container.querySelector('iframe')\n        IFRAME.setAttribute('src', '')\n        IFRAME.style.opacity = '0'\n      }\n    },\n\n    youtube: {\n      checkSupport (el) {\n        return checkType(el, 'youtube')\n      },\n\n      init (el, container) {\n        const IFRAME_PLACEHOLDER = document.createElement('div')\n\n        // Add iframePlaceholder to container\n        container.appendChild(IFRAME_PLACEHOLDER)\n\n        PLAYER[playerId] = new window.YT.Player(IFRAME_PLACEHOLDER, {\n          host: 'https://www.youtube-nocookie.com',\n          height: el.getAttribute('data-height') || '360',\n          width: el.getAttribute('data-width') || '640',\n          videoId: el.getAttribute('data-id'),\n          playerVars: {\n            controls: el.getAttribute('data-controls') || 1,\n            rel: 0,\n            playsinline: 1\n          }\n        })\n\n        // Set player ID\n        container.setAttribute('data-player', playerId)\n\n        // Register type\n        container.setAttribute('data-type', 'youtube')\n        container.classList.add('tobii-youtube')\n\n        playerId++\n      },\n\n      onPreload (container) {\n        // Nothing\n      },\n\n      onLoad (container) {\n        if (config.autoplayVideo) {\n          PLAYER[container.getAttribute('data-player')].playVideo()\n        }\n      },\n\n      onLeave (container) {\n        if (PLAYER[container.getAttribute('data-player')].getPlayerState() === 1) {\n          PLAYER[container.getAttribute('data-player')].pauseVideo()\n        }\n      },\n\n      onCleanup (container) {\n        if (PLAYER[container.getAttribute('data-player')].getPlayerState() === 1) {\n          PLAYER[container.getAttribute('data-player')].pauseVideo()\n        }\n      }\n    }\n  }\n\n  /**\n   * Init\n   *\n   */\n  const init = (userOptions) => {\n    // Merge user options into defaults\n    config = mergeOptions(userOptions)\n\n    // Check if the lightbox already exists\n    if (!lightbox) {\n      createLightbox()\n    }\n\n    // Get a list of all elements within the document\n    const LIGHTBOX_TRIGGER_ELS = document.querySelectorAll(config.selector)\n\n    if (!LIGHTBOX_TRIGGER_ELS) {\n      throw new Error(`Ups, I can't find the selector ${config.selector} on this website.`)\n    }\n\n    // Execute a few things once per element\n    LIGHTBOX_TRIGGER_ELS.forEach((lightboxTriggerEl) => {\n      checkDependencies(lightboxTriggerEl)\n    })\n  }\n\n  /**\n   * Check dependencies\n   *\n   * @param {HTMLElement} el - Element to add\n   */\n  const checkDependencies = (el) => {\n    // Check if there is a YouTube video and if the YouTube iframe-API is ready\n    if (document.querySelector('[data-type=\"youtube\"]') !== null && !isYouTubeDependencieLoaded) {\n      if (document.getElementById('iframe_api') === null) {\n        const TAG = document.createElement('script')\n        const FIRST_SCRIPT_TAG = document.getElementsByTagName('script')[0]\n\n        TAG.id = 'iframe_api'\n        TAG.src = 'https://www.youtube.com/iframe_api'\n\n        FIRST_SCRIPT_TAG.parentNode.insertBefore(TAG, FIRST_SCRIPT_TAG)\n      }\n\n      if (WAITING_ELS.indexOf(el) === -1) {\n        WAITING_ELS.push(el)\n      }\n\n      window.onYouTubePlayerAPIReady = () => {\n        WAITING_ELS.forEach((waitingEl) => {\n          add(waitingEl)\n        })\n\n        isYouTubeDependencieLoaded = true\n      }\n    } else {\n      add(el)\n    }\n  }\n\n  /**\n   * Get group name from element\n   *\n   * @param {HTMLElement} el\n   * @return {string}\n   */\n  const getGroupName = (el) => {\n    return el.hasAttribute('data-group') ? el.getAttribute('data-group') : 'default'\n  }\n\n  /**\n   * Copy an object. (The secure way)\n   *\n   * @param {object} object\n   * @return {object}\n   */\n  const copyObject = (object) => {\n    return JSON.parse(JSON.stringify(object))\n  }\n\n  /**\n   * Add element\n   *\n   * @param {HTMLElement} el - Element to add\n   */\n  const add = (el) => {\n    newGroup = getGroupName(el)\n\n    if (!Object.prototype.hasOwnProperty.call(groups, newGroup)) {\n      groups[newGroup] = copyObject(GROUP_ATTS)\n\n      createSlider()\n    }\n\n    // Check if element already exists\n    if (groups[newGroup].gallery.indexOf(el) === -1) {\n      groups[newGroup].gallery.push(el)\n      groups[newGroup].elementsLength++\n\n      // Set zoom icon if necessary\n      if (config.zoom && el.querySelector('img')) {\n        const TOBII_ZOOM = document.createElement('div')\n\n        TOBII_ZOOM.className = 'tobii-zoom__icon'\n        TOBII_ZOOM.innerHTML = config.zoomText\n\n        el.classList.add('tobii-zoom')\n        el.appendChild(TOBII_ZOOM)\n      }\n\n      // Bind click event handler\n      el.addEventListener('click', triggerTobii)\n\n      createSlide(el)\n\n      if (isOpen() && newGroup === activeGroup) {\n        updateConfig()\n        updateLightbox()\n      }\n    } else {\n      throw new Error('Ups, element already added.')\n    }\n  }\n\n  /**\n   * Remove element\n   *\n   * @param {HTMLElement} el - Element to remove\n   */\n  const remove = (el) => {\n    const GROUP_NAME = getGroupName(el)\n\n    // Check if element exists\n    if (groups[GROUP_NAME].gallery.indexOf(el) === -1) {\n      throw new Error(`Ups, I can't find a slide for the element ${el}.`)\n    } else {\n      const SLIDE_INDEX = groups[GROUP_NAME].gallery.indexOf(el)\n      const SLIDE_EL = groups[GROUP_NAME].sliderElements[SLIDE_INDEX]\n\n      // If the element to be removed is the currently visible slide\n      if (isOpen() && GROUP_NAME === activeGroup && SLIDE_INDEX === groups[GROUP_NAME].currentIndex) {\n        if (groups[GROUP_NAME].elementsLength === 1) {\n          close()\n          throw new Error('Ups, I\\'ve closed. There are no slides more to show.')\n        } else {\n          // TODO If there is only one slide left, deactivate horizontal dragging/ swiping\n          // TODO Recalculate counter\n          // TODO Set new absolute position per slide\n\n          // If the first slide is displayed\n          if (groups[GROUP_NAME].currentIndex === 0) {\n            next()\n          } else {\n            previous()\n          }\n        }\n      }\n\n      // TODO Remove element\n      // groups[GROUP_NAME].gallery.splice(groups[GROUP_NAME].gallery.indexOf(el)) don't work\n      groups[GROUP_NAME].elementsLength--\n\n      // Remove zoom icon if necessary\n      if (config.zoom && el.querySelector('.tobii-zoom__icon')) {\n        const ZOOM_ICON = el.querySelector('.tobii-zoom__icon')\n\n        ZOOM_ICON.parentNode.classList.remove('tobii-zoom')\n        ZOOM_ICON.parentNode.removeChild(ZOOM_ICON)\n      }\n\n      // Unbind click event handler\n      el.removeEventListener('click', triggerTobii)\n\n      // Remove slide\n      SLIDE_EL.parentNode.removeChild(SLIDE_EL)\n    }\n  }\n\n  /**\n   * Create the lightbox\n   *\n   */\n  const createLightbox = () => {\n    // Create the lightbox container\n    lightbox = document.createElement('div')\n    lightbox.setAttribute('role', 'dialog')\n    lightbox.setAttribute('aria-hidden', 'true')\n    lightbox.classList.add('tobii')\n\n    // Adc theme class\n    lightbox.classList.add(config.theme)\n\n    // Create the previous button\n    prevButton = document.createElement('button')\n    prevButton.className = 'tobii__btn tobii__btn--previous'\n    prevButton.setAttribute('type', 'button')\n    prevButton.setAttribute('aria-label', config.navLabel[0])\n    prevButton.innerHTML = config.navText[0]\n    lightbox.appendChild(prevButton)\n\n    // Create the next button\n    nextButton = document.createElement('button')\n    nextButton.className = 'tobii__btn tobii__btn--next'\n    nextButton.setAttribute('type', 'button')\n    nextButton.setAttribute('aria-label', config.navLabel[1])\n    nextButton.innerHTML = config.navText[1]\n    lightbox.appendChild(nextButton)\n\n    // Create the close button\n    closeButton = document.createElement('button')\n    closeButton.className = 'tobii__btn tobii__btn--close'\n    closeButton.setAttribute('type', 'button')\n    closeButton.setAttribute('aria-label', config.closeLabel)\n    closeButton.innerHTML = config.closeText\n    lightbox.appendChild(closeButton)\n\n    // Create the counter\n    counter = document.createElement('div')\n    counter.className = 'tobii__counter'\n    lightbox.appendChild(counter)\n\n    document.body.appendChild(lightbox)\n  }\n\n  /**\n   * Create a slider\n   */\n  const createSlider = () => {\n    groups[newGroup].slider = document.createElement('div')\n    groups[newGroup].slider.className = 'tobii__slider'\n\n    // Hide slider\n    groups[newGroup].slider.setAttribute('aria-hidden', 'true')\n\n    lightbox.appendChild(groups[newGroup].slider)\n  }\n\n  /**\n   * Create a slide\n   *\n   */\n  const createSlide = (el) => {\n    // Detect type\n    for (const index in SUPPORTED_ELEMENTS) {\n      if (Object.prototype.hasOwnProperty.call(SUPPORTED_ELEMENTS, index)) {\n        if (SUPPORTED_ELEMENTS[index].checkSupport(el)) {\n          // Create slide elements\n          const SLIDER_ELEMENT = document.createElement('div')\n          const SLIDER_ELEMENT_CONTENT = document.createElement('div')\n\n          SLIDER_ELEMENT.className = 'tobii__slide'\n          SLIDER_ELEMENT.style.position = 'absolute'\n          SLIDER_ELEMENT.style.left = `${groups[newGroup].x * 100}%`\n\n          // Hide slide\n          SLIDER_ELEMENT.setAttribute('aria-hidden', 'true')\n\n          // Create type elements\n          SUPPORTED_ELEMENTS[index].init(el, SLIDER_ELEMENT_CONTENT)\n\n          // Add slide content container to slider element\n          SLIDER_ELEMENT.appendChild(SLIDER_ELEMENT_CONTENT)\n\n          // Add slider element to slider\n          groups[newGroup].slider.appendChild(SLIDER_ELEMENT)\n          groups[newGroup].sliderElements.push(SLIDER_ELEMENT)\n\n          ++groups[newGroup].x\n\n          break\n        }\n      }\n    }\n  }\n\n  /**\n   * Open Tobii\n   *\n   * @param {number} index - Index to load\n   */\n  const open = (index) => {\n    activeGroup = activeGroup !== null ? activeGroup : newGroup\n\n    if (isOpen()) {\n      throw new Error('Ups, I\\'m aleady open.')\n    }\n\n    if (!isOpen()) {\n      if (!index) {\n        index = 0\n      }\n\n      if (index === -1 || index >= groups[activeGroup].elementsLength) {\n        throw new Error(`Ups, I can't find slide ${index}.`)\n      }\n    }\n\n    if (config.hideScrollbar) {\n      document.documentElement.classList.add('tobii-is-open')\n      document.body.classList.add('tobii-is-open')\n    }\n\n    updateConfig()\n\n    // Hide close if necessary\n    if (!config.close) {\n      closeButton.disabled = false\n      closeButton.setAttribute('aria-hidden', 'true')\n    }\n\n    // Save user’s focus\n    lastFocus = document.activeElement\n\n    // Use `history.pushState()` to make sure the \"Back\" button behavior\n    // that aligns with the user's expectations\n    const stateObj = {\n      tobii: 'close'\n    }\n    const url = window.location.href\n\n    window.history.pushState(stateObj, 'Image', url)\n\n    // Set current index\n    groups[activeGroup].currentIndex = index\n\n    clearDrag()\n    bindEvents()\n\n    // Load slide\n    load(groups[activeGroup].currentIndex)\n\n    // Show slider\n    groups[activeGroup].slider.setAttribute('aria-hidden', 'false')\n\n    // Show lightbox\n    lightbox.setAttribute('aria-hidden', 'false')\n\n    updateLightbox()\n\n    // Preload previous and next slide\n    preload(groups[activeGroup].currentIndex + 1)\n    preload(groups[activeGroup].currentIndex - 1)\n\n    // Hack to prevent animation during opening\n    setTimeout(() => {\n      groups[activeGroup].slider.classList.add('tobii__slider--animate')\n    }, 1000)\n\n    // Create and dispatch a new event\n    const openEvent = new window.CustomEvent('open', {\n      detail: {\n        group: activeGroup\n      }\n    })\n\n    lightbox.dispatchEvent(openEvent)\n  }\n\n  /**\n   * Close Tobii\n   *\n   */\n  const close = () => {\n    if (!isOpen()) {\n      throw new Error('Ups, I\\'m already closed.')\n    }\n\n    if (config.hideScrollbar) {\n      document.documentElement.classList.remove('tobii-is-open')\n      document.body.classList.remove('tobii-is-open')\n    }\n\n    unbindEvents()\n\n    // Remove entry in browser history\n    if (window.history.state !== null) {\n      if (window.history.state.tobii === 'close') {\n        window.history.back()\n      }\n    }\n\n    // Reenable the user’s focus\n    lastFocus.focus()\n\n    // Don't forget to cleanup our current element\n    leave(groups[activeGroup].currentIndex)\n    cleanup(groups[activeGroup].currentIndex)\n\n    // Hide lightbox\n    lightbox.setAttribute('aria-hidden', 'true')\n\n    // Hide slider\n    groups[activeGroup].slider.setAttribute('aria-hidden', 'true')\n\n    // Reset current index\n    groups[activeGroup].currentIndex = 0\n\n    // Remove the hack to prevent animation during opening\n    groups[activeGroup].slider.classList.remove('tobii__slider--animate')\n\n    // Create and dispatch a new event\n    const closeEvent = new window.CustomEvent('close', {\n      detail: {\n        group: activeGroup\n      }\n    })\n    lightbox.dispatchEvent(closeEvent)\n  }\n\n  /**\n   * Preload slide\n   *\n   * @param {number} index - Index to preload\n   */\n  const preload = (index) => {\n    if (groups[activeGroup].sliderElements[index] === undefined) {\n      return\n    }\n\n    const CONTAINER = groups[activeGroup].sliderElements[index].querySelector('[data-type]')\n    const TYPE = CONTAINER.getAttribute('data-type')\n\n    SUPPORTED_ELEMENTS[TYPE].onPreload(CONTAINER)\n  }\n\n  /**\n   * Load slide\n   * Will be called when opening the lightbox or moving index\n   *\n   * @param {number} index - Index to load\n   */\n  const load = (index) => {\n    if (groups[activeGroup].sliderElements[index] === undefined) {\n      return\n    }\n\n    const CONTAINER = groups[activeGroup].sliderElements[index].querySelector('[data-type]')\n    const TYPE = CONTAINER.getAttribute('data-type')\n\n    // Add active slide class\n    groups[activeGroup].sliderElements[index].classList.add('tobii__slide--is-active')\n    groups[activeGroup].sliderElements[index].setAttribute('aria-hidden', 'false')\n\n    SUPPORTED_ELEMENTS[TYPE].onLoad(CONTAINER)\n  }\n\n  /**\n   * Select a slide\n   *\n   * @param {number} index - Index to select\n   */\n  const select = (index) => {\n    const currIndex = groups[activeGroup].currentIndex\n\n    if (!isOpen()) {\n      throw new Error('Ups, I\\'m closed.')\n    }\n\n    if (isOpen()) {\n      if (!index && index !== 0) {\n        throw new Error('Ups, no slide specified.')\n      }\n\n      if (index === groups[activeGroup].currentIndex) {\n        throw new Error(`Ups, slide ${index} is already selected.`)\n      }\n\n      if (index === -1 || index >= groups[activeGroup].elementsLength) {\n        throw new Error(`Ups, I can't find slide ${index}.`)\n      }\n    }\n\n    // Set current index\n    groups[activeGroup].currentIndex = index\n\n    leave(currIndex)\n    load(index)\n\n    if (index < currIndex) {\n      updateLightbox('left')\n      cleanup(currIndex)\n      preload(index - 1)\n    }\n\n    if (index > currIndex) {\n      updateLightbox('right')\n      cleanup(currIndex)\n      preload(index + 1)\n    }\n  }\n\n  /**\n   * Select the previous slide\n   *\n   */\n  const previous = () => {\n    if (!isOpen()) {\n      throw new Error('Ups, I\\'m closed.')\n    }\n\n    if (groups[activeGroup].currentIndex > 0) {\n      leave(groups[activeGroup].currentIndex)\n      load(--groups[activeGroup].currentIndex)\n      updateLightbox('left')\n      cleanup(groups[activeGroup].currentIndex + 1)\n      preload(groups[activeGroup].currentIndex - 1)\n    }\n\n    // Create and dispatch a new event\n    const previousEvent = new window.CustomEvent('previous', {\n      detail: {\n        group: activeGroup\n      }\n    })\n\n    lightbox.dispatchEvent(previousEvent)\n  }\n\n  /**\n   * Select the next slide\n   *\n   */\n  const next = () => {\n    if (!isOpen()) {\n      throw new Error('Ups, I\\'m closed.')\n    }\n\n    if (groups[activeGroup].currentIndex < groups[activeGroup].elementsLength - 1) {\n      leave(groups[activeGroup].currentIndex)\n      load(++groups[activeGroup].currentIndex)\n      updateLightbox('right')\n      cleanup(groups[activeGroup].currentIndex - 1)\n      preload(groups[activeGroup].currentIndex + 1)\n    }\n\n    // Create and dispatch a new event\n    const nextEvent = new window.CustomEvent('next', {\n      detail: {\n        group: activeGroup\n      }\n    })\n\n    lightbox.dispatchEvent(nextEvent)\n  }\n\n  /**\n   * Select a group\n   *\n   * @param {string} name - Name of the group to select\n   */\n  const selectGroup = (name) => {\n    if (isOpen()) {\n      throw new Error('Ups, I\\'m open.')\n    }\n\n    if (!name) {\n      throw new Error('Ups, no group specified.')\n    }\n\n    if (name && !Object.prototype.hasOwnProperty.call(groups, name)) {\n      throw new Error(`Ups, I don't have a group called \"${name}\".`)\n    }\n\n    activeGroup = name\n  }\n\n  /**\n   * Leave slide\n   * Will be called before moving index\n   *\n   * @param {number} index - Index to leave\n   */\n  const leave = (index) => {\n    if (groups[activeGroup].sliderElements[index] === undefined) {\n      return\n    }\n\n    const CONTAINER = groups[activeGroup].sliderElements[index].querySelector('[data-type]')\n    const TYPE = CONTAINER.getAttribute('data-type')\n\n    // Remove active slide class\n    groups[activeGroup].sliderElements[index].classList.remove('tobii__slide--is-active')\n    groups[activeGroup].sliderElements[index].setAttribute('aria-hidden', 'true')\n\n    SUPPORTED_ELEMENTS[TYPE].onLeave(CONTAINER)\n  }\n\n  /**\n   * Cleanup slide\n   * Will be called after moving index\n   *\n   * @param {number} index - Index to cleanup\n   */\n  const cleanup = (index) => {\n    if (groups[activeGroup].sliderElements[index] === undefined) {\n      return\n    }\n\n    const CONTAINER = groups[activeGroup].sliderElements[index].querySelector('[data-type]')\n    const TYPE = CONTAINER.getAttribute('data-type')\n\n    SUPPORTED_ELEMENTS[TYPE].onCleanup(CONTAINER)\n  }\n\n  /**\n   * Update offset\n   *\n   */\n  const updateOffset = () => {\n    activeGroup = activeGroup !== null ? activeGroup : newGroup\n\n    offset = -groups[activeGroup].currentIndex * lightbox.offsetWidth\n\n    groups[activeGroup].slider.style.transform = `translate3d(${offset}px, 0, 0)`\n    offsetTmp = offset\n  }\n\n  /**\n   * Update counter\n   *\n   */\n  const updateCounter = () => {\n    counter.textContent = `${groups[activeGroup].currentIndex + 1}/${groups[activeGroup].elementsLength}`\n  }\n\n  /**\n   * Update focus\n   *\n   * @param {string} dir - Current slide direction\n   */\n  const updateFocus = (dir) => {\n    if ((config.nav === true || config.nav === 'auto') && !isTouchDevice() && groups[activeGroup].elementsLength > 1) {\n      prevButton.setAttribute('aria-hidden', 'true')\n      prevButton.disabled = true\n      nextButton.setAttribute('aria-hidden', 'true')\n      nextButton.disabled = true\n\n      // If there is only one slide\n      if (groups[activeGroup].elementsLength === 1) {\n        if (config.close) {\n          closeButton.focus()\n        }\n      } else {\n        // If the first slide is displayed\n        if (groups[activeGroup].currentIndex === 0) {\n          nextButton.setAttribute('aria-hidden', 'false')\n          nextButton.disabled = false\n\n          nextButton.focus()\n\n          // If the last slide is displayed\n        } else if (groups[activeGroup].currentIndex === groups[activeGroup].elementsLength - 1) {\n          prevButton.setAttribute('aria-hidden', 'false')\n          prevButton.disabled = false\n\n          prevButton.focus()\n        } else {\n          prevButton.setAttribute('aria-hidden', 'false')\n          prevButton.disabled = false\n          nextButton.setAttribute('aria-hidden', 'false')\n          nextButton.disabled = false\n\n          if (dir === 'left') {\n            prevButton.focus()\n          } else {\n            nextButton.focus()\n          }\n        }\n      }\n    } else if (config.close) {\n      closeButton.focus()\n    }\n  }\n\n  /**\n   * Clear drag after touchend and mousup event\n   *\n   */\n  const clearDrag = () => {\n    drag = {\n      startX: 0,\n      endX: 0,\n      startY: 0,\n      endY: 0\n    }\n  }\n\n  /**\n   * Recalculate drag / swipe event\n   *\n   */\n  const updateAfterDrag = () => {\n    const MOVEMENT_X = drag.endX - drag.startX\n    const MOVEMENT_Y = drag.endY - drag.startY\n    const MOVEMENT_X_DISTANCE = Math.abs(MOVEMENT_X)\n    const MOVEMENT_Y_DISTANCE = Math.abs(MOVEMENT_Y)\n\n    if (MOVEMENT_X > 0 && MOVEMENT_X_DISTANCE > config.threshold && groups[activeGroup].currentIndex > 0) {\n      previous()\n    } else if (MOVEMENT_X < 0 && MOVEMENT_X_DISTANCE > config.threshold && groups[activeGroup].currentIndex !== groups[activeGroup].elementsLength - 1) {\n      next()\n    } else if (MOVEMENT_Y < 0 && MOVEMENT_Y_DISTANCE > config.threshold && config.swipeClose) {\n      close()\n    } else {\n      updateOffset()\n    }\n  }\n\n  /**\n   * Resize event using requestAnimationFrame\n   *\n   */\n  const resizeHandler = () => {\n    if (!resizeTicking) {\n      resizeTicking = true\n\n      window.requestAnimationFrame(() => {\n        updateOffset()\n\n        resizeTicking = false\n      })\n    }\n  }\n\n  /**\n   * Click event handler to trigger Tobii\n   *\n   */\n  const triggerTobii = (event) => {\n    event.preventDefault()\n\n    activeGroup = getGroupName(event.currentTarget)\n\n    open(groups[activeGroup].gallery.indexOf(event.currentTarget))\n  }\n\n  /**\n   * Click event handler\n   *\n   */\n  const clickHandler = (event) => {\n    if (event.target === prevButton) {\n      previous()\n    } else if (event.target === nextButton) {\n      next()\n    } else if (event.target === closeButton || (isDraggingX === false && isDraggingY === false && event.target.classList.contains('tobii__slide') && config.docClose)) {\n      close()\n    }\n\n    event.stopPropagation()\n  }\n\n  /**\n   * Get the focusable children of the given element\n   *\n   * @return {Array<Element>}\n   */\n  const getFocusableChildren = () => {\n    return Array.prototype.slice.call(lightbox.querySelectorAll(`.tobii__btn:not([disabled]), .tobii__slide--is-active + ${FOCUSABLE_ELEMENTS.join(', .tobii__slide--is-active ')}`)).filter((child) => {\n      return !!(\n        child.offsetWidth ||\n        child.offsetHeight ||\n        child.getClientRects().length\n      )\n    })\n  }\n\n  /**\n   * Keydown event handler\n   *\n   * @TODO: Remove the deprecated event.keyCode when Edge support event.code and we drop f*cking IE\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode\n   */\n  const keydownHandler = (event) => {\n    const FOCUSABLE_CHILDREN = getFocusableChildren()\n    const FOCUSED_ITEM_INDEX = FOCUSABLE_CHILDREN.indexOf(document.activeElement)\n\n    if (event.keyCode === 9 || event.code === 'Tab') {\n      // If the SHIFT key is being pressed while tabbing (moving backwards) and\n      // the currently focused item is the first one, move the focus to the last\n      // focusable item from the slide\n      if (event.shiftKey && FOCUSED_ITEM_INDEX === 0) {\n        FOCUSABLE_CHILDREN[FOCUSABLE_CHILDREN.length - 1].focus()\n        event.preventDefault()\n        // If the SHIFT key is not being pressed (moving forwards) and the currently\n        // focused item is the last one, move the focus to the first focusable item\n        // from the slide\n      } else if (!event.shiftKey && FOCUSED_ITEM_INDEX === FOCUSABLE_CHILDREN.length - 1) {\n        FOCUSABLE_CHILDREN[0].focus()\n        event.preventDefault()\n      }\n    } else if (event.keyCode === 27 || event.code === 'Escape') {\n      // `ESC` Key: Close Tobii\n      event.preventDefault()\n      close()\n    } else if (event.keyCode === 37 || event.code === 'ArrowLeft') {\n      // `PREV` Key: Show the previous slide\n      event.preventDefault()\n      previous()\n    } else if (event.keyCode === 39 || event.code === 'ArrowRight') {\n      // `NEXT` Key: Show the next slide\n      event.preventDefault()\n      next()\n    }\n  }\n\n  /**\n   * Touchstart event handler\n   *\n   */\n  const touchstartHandler = (event) => {\n    // Prevent dragging / swiping on textareas inputs and selects\n    if (isIgnoreElement(event.target)) {\n      return\n    }\n\n    event.stopPropagation()\n\n    isDraggingX = false\n    isDraggingY = false\n\n    pointerDown = true\n\n    drag.startX = event.touches[0].pageX\n    drag.startY = event.touches[0].pageY\n\n    groups[activeGroup].slider.classList.add('tobii__slider--is-dragging')\n  }\n\n  /**\n   * Touchmove event handler\n   *\n   */\n  const touchmoveHandler = (event) => {\n    event.stopPropagation()\n\n    if (pointerDown) {\n      event.preventDefault()\n\n      drag.endX = event.touches[0].pageX\n      drag.endY = event.touches[0].pageY\n\n      doSwipe()\n    }\n  }\n\n  /**\n   * Touchend event handler\n   *\n   */\n  const touchendHandler = (event) => {\n    event.stopPropagation()\n\n    pointerDown = false\n\n    groups[activeGroup].slider.classList.remove('tobii__slider--is-dragging')\n\n    if (drag.endX) {\n      updateAfterDrag()\n    }\n\n    clearDrag()\n  }\n\n  /**\n   * Mousedown event handler\n   *\n   */\n  const mousedownHandler = (event) => {\n    // Prevent dragging / swiping on textareas inputs and selects\n    if (isIgnoreElement(event.target)) {\n      return\n    }\n\n    event.preventDefault()\n    event.stopPropagation()\n\n    isDraggingX = false\n    isDraggingY = false\n\n    pointerDown = true\n\n    drag.startX = event.pageX\n    drag.startY = event.pageY\n\n    groups[activeGroup].slider.classList.add('tobii__slider--is-dragging')\n  }\n\n  /**\n   * Mousemove event handler\n   *\n   */\n  const mousemoveHandler = (event) => {\n    event.preventDefault()\n\n    if (pointerDown) {\n      drag.endX = event.pageX\n      drag.endY = event.pageY\n\n      doSwipe()\n    }\n  }\n\n  /**\n   * Mouseup event handler\n   *\n   */\n  const mouseupHandler = (event) => {\n    event.stopPropagation()\n\n    pointerDown = false\n\n    groups[activeGroup].slider.classList.remove('tobii__slider--is-dragging')\n\n    if (drag.endX) {\n      updateAfterDrag()\n    }\n\n    clearDrag()\n  }\n\n  /**\n   * Contextmenu event handler\n   * This is a fix for chromium based browser on mac.\n   * The 'contextmenu' terminates a mouse event sequence.\n   * https://bugs.chromium.org/p/chromium/issues/detail?id=506801\n   *\n   */\n  const contextmenuHandler = () => {\n    pointerDown = false\n  }\n\n  /**\n   * Decide whether to do horizontal of vertical swipe\n   *\n   */\n  const doSwipe = () => {\n    if (Math.abs(drag.startX - drag.endX) > 0 && !isDraggingY && groups[activeGroup].elementsLength > 1) {\n      // Horizontal swipe\n      groups[activeGroup].slider.style.transform = `translate3d(${offsetTmp - Math.round(drag.startX - drag.endX)}px, 0, 0)`\n\n      isDraggingX = true\n      isDraggingY = false\n    } else if (Math.abs(drag.startY - drag.endY) > 0 && !isDraggingX && config.swipeClose) {\n      // Vertical swipe\n      groups[activeGroup].slider.style.transform = `translate3d(${offsetTmp}px, -${Math.round(drag.startY - drag.endY)}px, 0)`\n\n      isDraggingX = false\n      isDraggingY = true\n    }\n  }\n\n  /**\n   * Bind events\n   *\n   */\n  const bindEvents = () => {\n    if (config.keyboard) {\n      window.addEventListener('keydown', keydownHandler)\n    }\n\n    // Resize event\n    window.addEventListener('resize', resizeHandler)\n\n    // Popstate event\n    window.addEventListener('popstate', close)\n\n    // Click event\n    lightbox.addEventListener('click', clickHandler)\n\n    if (config.draggable) {\n      if (isTouchDevice()) {\n        // Touch events\n        lightbox.addEventListener('touchstart', touchstartHandler)\n        lightbox.addEventListener('touchmove', touchmoveHandler)\n        lightbox.addEventListener('touchend', touchendHandler)\n      }\n\n      // Mouse events\n      lightbox.addEventListener('mousedown', mousedownHandler)\n      lightbox.addEventListener('mouseup', mouseupHandler)\n      lightbox.addEventListener('mousemove', mousemoveHandler)\n      lightbox.addEventListener('contextmenu', contextmenuHandler)\n    }\n  }\n\n  /**\n   * Unbind events\n   *\n   */\n  const unbindEvents = () => {\n    if (config.keyboard) {\n      window.removeEventListener('keydown', keydownHandler)\n    }\n\n    // Resize event\n    window.removeEventListener('resize', resizeHandler)\n\n    // Popstate event\n    window.removeEventListener('popstate', close)\n\n    // Click event\n    lightbox.removeEventListener('click', clickHandler)\n\n    if (config.draggable) {\n      if (isTouchDevice()) {\n        // Touch events\n        lightbox.removeEventListener('touchstart', touchstartHandler)\n        lightbox.removeEventListener('touchmove', touchmoveHandler)\n        lightbox.removeEventListener('touchend', touchendHandler)\n      }\n\n      // Mouse events\n      lightbox.removeEventListener('mousedown', mousedownHandler)\n      lightbox.removeEventListener('mouseup', mouseupHandler)\n      lightbox.removeEventListener('mousemove', mousemoveHandler)\n      lightbox.removeEventListener('contextmenu', contextmenuHandler)\n    }\n  }\n\n  /**\n   * Checks whether element has requested data-type value\n   *\n   */\n  const checkType = (el, type) => {\n    return el.getAttribute('data-type') === type\n  }\n\n  /**\n   * Remove all `src` attributes\n   *\n   * @param {HTMLElement} el - Element to remove all `src` attributes\n   */\n  const removeSources = (el) => {\n    const SOURCES = el.querySelectorAll('src')\n\n    if (SOURCES) {\n      SOURCES.forEach((source) => {\n        source.setAttribute('src', '')\n      })\n    }\n  }\n\n  /**\n   * Update Config\n   *\n   */\n  const updateConfig = () => {\n    if ((config.draggable && config.swipeClose && !groups[activeGroup].slider.classList.contains('tobii__slider--is-draggable')) || (config.draggable && groups[activeGroup].elementsLength > 1 && !groups[activeGroup].slider.classList.contains('tobii__slider--is-draggable'))) {\n      groups[activeGroup].slider.classList.add('tobii__slider--is-draggable')\n    }\n\n    // Hide buttons if necessary\n    if (!config.nav || groups[activeGroup].elementsLength === 1 || (config.nav === 'auto' && isTouchDevice())) {\n      prevButton.setAttribute('aria-hidden', 'true')\n      prevButton.disabled = true\n      nextButton.setAttribute('aria-hidden', 'true')\n      nextButton.disabled = true\n    } else {\n      prevButton.setAttribute('aria-hidden', 'false')\n      prevButton.disabled = false\n      nextButton.setAttribute('aria-hidden', 'false')\n      nextButton.disabled = false\n    }\n\n    // Hide counter if necessary\n    if (!config.counter || groups[activeGroup].elementsLength === 1) {\n      counter.setAttribute('aria-hidden', 'true')\n    } else {\n      counter.setAttribute('aria-hidden', 'false')\n    }\n  }\n\n  /**\n   * Update lightbox\n   *\n   * @param {string} dir - Current slide direction\n   */\n  const updateLightbox = (dir) => {\n    updateOffset()\n    updateCounter()\n    updateFocus(dir)\n  }\n\n  /**\n   * Reset Tobii\n   *\n   */\n  const reset = () => {\n    if (isOpen()) {\n      close()\n    }\n\n    // TODO Cleanup\n    const GROUPS_ENTRIES = Object.entries(groups)\n\n    GROUPS_ENTRIES.forEach((groupsEntrie) => {\n      const SLIDE_ELS = groupsEntrie[1].gallery\n\n      // Remove slides\n      SLIDE_ELS.forEach((slideEl) => {\n        remove(slideEl)\n      })\n    })\n\n    groups = {}\n    newGroup = activeGroup = null\n    figcaptionId = 0\n\n    // TODO\n  }\n\n  /**\n   * Destroy Tobii\n   *\n   */\n  const destroy = () => {\n    reset()\n\n    lightbox.parentNode.removeChild(lightbox)\n  }\n\n  /**\n   * Check if Tobii is open\n   *\n   */\n  const isOpen = () => {\n    return lightbox.getAttribute('aria-hidden') === 'false'\n  }\n\n  /**\n   * Detect whether device is touch capable\n   *\n   */\n  const isTouchDevice = () => {\n    return 'ontouchstart' in window\n  }\n\n  /**\n   * Checks whether element's nodeName is part of array\n   *\n   */\n  const isIgnoreElement = (el) => {\n    return ['TEXTAREA', 'OPTION', 'INPUT', 'SELECT'].indexOf(el.nodeName) !== -1 || el === prevButton || el === nextButton || el === closeButton\n  }\n\n  /**\n   * Return current index\n   *\n   */\n  const slidesIndex = () => {\n    return groups[activeGroup].currentIndex\n  }\n\n  /**\n   * Return elements length\n   *\n   */\n  const slidesCount = () => {\n    return groups[activeGroup].elementsLength\n  }\n\n  /**\n   * Return current group\n   *\n   */\n  const currentGroup = () => {\n    return activeGroup !== null ? activeGroup : newGroup\n  }\n\n  /**\n   * Bind events\n   * @param {String} eventName\n   * @param {function} callback - callback to call\n   *\n   */\n  const on = (eventName, callback) => {\n    lightbox.addEventListener(eventName, callback)\n  }\n\n  /**\n   * Unbind events\n   * @param {String} eventName\n   * @param {function} callback - callback to call\n   *\n   */\n  const off = (eventName, callback) => {\n    lightbox.removeEventListener(eventName, callback)\n  }\n\n  init(userOptions)\n\n  Tobii.open = open\n  Tobii.previous = previous\n  Tobii.next = next\n  Tobii.close = close\n  Tobii.add = checkDependencies\n  Tobii.remove = remove\n  Tobii.reset = reset\n  Tobii.destroy = destroy\n  Tobii.isOpen = isOpen\n  Tobii.slidesIndex = slidesIndex\n  Tobii.select = select\n  Tobii.slidesCount = slidesCount\n  Tobii.selectGroup = selectGroup\n  Tobii.currentGroup = currentGroup\n  Tobii.on = on\n  Tobii.off = off\n\n  return Tobii\n}\n"],"names":["Tobii","userOptions","FOCUSABLE_ELEMENTS","WAITING_ELS","GROUP_ATTS","gallery","slider","sliderElements","elementsLength","currentIndex","x","PLAYER","config","figcaptionId","lightbox","prevButton","nextButton","closeButton","counter","drag","isDraggingX","isDraggingY","pointerDown","lastFocus","offset","offsetTmp","resizeTicking","isYouTubeDependencieLoaded","playerId","groups","newGroup","activeGroup","SUPPORTED_ELEMENTS","image","checkSupport","el","hasAttribute","href","match","init","container","FIGURE","document","createElement","FIGCAPTION","IMAGE","THUMBNAIL","querySelector","LOADING_INDICATOR","style","opacity","alt","setAttribute","getAttribute","appendChild","captions","captionText","textContent","captionsSelector","captionAttribute","id","className","loadingIndicatorLabel","classList","add","onPreload","onLoad","onload","removeChild","removeAttribute","onLeave","onCleanup","html","checkType","TARGET_SELECTOR","TARGET","Error","VIDEO","readyState","currentTime","autoplayVideo","play","paused","pause","duration","VIDEO_CLONE","cloneNode","removeSources","load","parentNode","iframe","IFRAME","HREF","indexOf","maxWidth","maxHeight","youtube","IFRAME_PLACEHOLDER","window","YT","Player","host","height","width","videoId","playerVars","controls","rel","playsinline","playVideo","getPlayerState","pauseVideo","checkDependencies","getElementById","TAG","FIRST_SCRIPT_TAG","getElementsByTagName","src","insertBefore","push","onYouTubePlayerAPIReady","forEach","waitingEl","getGroupName","Object","prototype","hasOwnProperty","call","JSON","parse","stringify","createSlider","zoom","TOBII_ZOOM","innerHTML","zoomText","addEventListener","triggerTobii","createSlide","isOpen","updateConfig","updateLightbox","remove","GROUP_NAME","SLIDE_INDEX","SLIDE_EL","close","next","previous","ZOOM_ICON","removeEventListener","index","SLIDER_ELEMENT","SLIDER_ELEMENT_CONTENT","position","left","open","hideScrollbar","documentElement","body","disabled","activeElement","url","location","history","pushState","tobii","clearDrag","bindEvents","preload","setTimeout","openEvent","CustomEvent","detail","group","dispatchEvent","unbindEvents","state","back","focus","leave","cleanup","closeEvent","undefined","CONTAINER","TYPE","previousEvent","nextEvent","updateOffset","offsetWidth","transform","startX","endX","startY","endY","updateAfterDrag","MOVEMENT_X","MOVEMENT_Y","MOVEMENT_X_DISTANCE","Math","abs","MOVEMENT_Y_DISTANCE","threshold","swipeClose","resizeHandler","requestAnimationFrame","event","preventDefault","currentTarget","clickHandler","target","contains","docClose","stopPropagation","keydownHandler","FOCUSABLE_CHILDREN","Array","slice","querySelectorAll","join","filter","child","offsetHeight","getClientRects","length","FOCUSED_ITEM_INDEX","keyCode","code","shiftKey","touchstartHandler","isIgnoreElement","touches","pageX","pageY","touchmoveHandler","doSwipe","touchendHandler","mousedownHandler","mousemoveHandler","mouseupHandler","contextmenuHandler","round","keyboard","draggable","isTouchDevice","type","SOURCES","source","nav","dir","updateFocus","reset","entries","groupsEntrie","slideEl","nodeName","selector","navText","navLabel","closeText","closeLabel","download","downloadText","downloadLabel","rtl","loop","modal","theme","mergeOptions","LIGHTBOX_TRIGGER_ELS","lightboxTriggerEl","destroy","slidesIndex","select","currIndex","slidesCount","selectGroup","name","currentGroup","on","eventName","callback","off"],"mappings":"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"}