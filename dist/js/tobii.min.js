(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.Tobii=b())})(this,function(){'use strict';function a(b){var c=Math.abs,d=window,e=["a[href]:not([tabindex^=\"-\"]):not([inert])","area[href]:not([tabindex^=\"-\"]):not([inert])","input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])","iframe:not([tabindex^=\"-\"]):not([inert])","audio:not([tabindex^=\"-\"]):not([inert])","video:not([tabindex^=\"-\"]):not([inert])","[contenteditable]:not([tabindex^=\"-\"]):not([inert])","[tabindex]:not([tabindex^=\"-\"]):not([inert])"],f=[],g={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},h=[],i={},j=0,k=null,l=null,m=null,n=null,o=null,p={},q=!1,r=!1,s=!1,t=null,u=null,v=null,w=!1,x=!1,y=0,z={},A=null,B=null,C=function(a){var b={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:["<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M14 18l-6-6 6-6\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M10 6l6 6-6 6\"/></svg>"],navLabel:["Previous image","Next image"],close:!0,closeText:"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M6 6l12 12M6 18L18 6\"/></svg>",closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!0,zoomText:"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M21 16v5h-5\"/><path d=\"M8 21H3v-5\"/><path d=\"M16 3h5v5\"/><path d=\"M3 8V3h5\"/></svg>",docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return a&&Object.keys(a).forEach(function(c){b[c]=a[c]}),b},D={image:{checkSupport:function(a){return!a.hasAttribute("data-type")&&a.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(a,b){var c=document.createElement("figure"),d=document.createElement("figcaption"),e=document.createElement("img"),f=a.querySelector("img"),g=document.createElement("div");c.style.opacity="0",f&&(e.alt=f.alt||""),e.setAttribute("src",""),e.setAttribute("data-src",a.href),c.appendChild(e),i.captions&&("self"===i.captionsSelector&&a.getAttribute(i.captionAttribute)?d.textContent=a.getAttribute(i.captionAttribute):"img"===i.captionsSelector&&f&&f.getAttribute(i.captionAttribute)&&(d.textContent=f.getAttribute(i.captionAttribute)),d.textContent&&(d.id="tobii-figcaption-"+j,c.appendChild(d),e.setAttribute("aria-labelledby",d.id),++j)),b.appendChild(c),g.className="tobii__loader",g.setAttribute("role","progressbar"),g.setAttribute("aria-label",i.loadingIndicatorLabel),b.appendChild(g),b.setAttribute("data-type","image")},onPreload:function(a){D.image.onLoad(a)},onLoad:function(a){var b=a.querySelector("img");if(b.hasAttribute("data-src")){var c=a.querySelector("figure"),d=a.querySelector(".tobii__loader");b.onload=function(){a.removeChild(d),c.style.opacity="1"},b.setAttribute("src",b.getAttribute("data-src")),b.removeAttribute("data-src")}},onLeave:function(){},onCleanup:function(){}},html:{checkSupport:function(a){return pa(a,"html")},init:function(a,b){var c=a.hasAttribute("href")?a.getAttribute("href"):a.getAttribute("data-target"),d=document.querySelector(c);if(!d)throw new Error("Ups, I can't find the target "+c+".");b.appendChild(d),b.setAttribute("data-type","html")},onPreload:function(){},onLoad:function(a){var b=a.querySelector("video");b&&(b.hasAttribute("data-time")&&0<b.readyState&&(b.currentTime=b.getAttribute("data-time")),i.autoplayVideo&&b.play())},onLeave:function(a){var b=a.querySelector("video");b&&(!b.paused&&b.pause(),0<b.readyState&&b.setAttribute("data-time",b.currentTime))},onCleanup:function(a){var b=a.querySelector("video");if(b&&0<b.readyState&&3>b.readyState&&b.duration!==b.currentTime){var c=b.cloneNode(!0);qa(b),b.load(),b.parentNode.removeChild(b),a.appendChild(c)}}},iframe:{checkSupport:function(a){return pa(a,"iframe")},init:function(a,b){var c=document.createElement("iframe"),d=a.hasAttribute("href")?a.getAttribute("href"):a.getAttribute("data-target");c.setAttribute("frameborder","0"),c.setAttribute("src",""),c.setAttribute("data-src",d),a.getAttribute("data-width")&&(c.style.maxWidth=a.getAttribute("data-width")+"px"),a.getAttribute("data-height")&&(c.style.maxHeight=a.getAttribute("data-height")+"px"),b.appendChild(c),b.setAttribute("data-type","iframe")},onPreload:function(){},onLoad:function(a){var b=a.querySelector("iframe");b.setAttribute("src",b.getAttribute("data-src"))},onLeave:function(){},onCleanup:function(){}},youtube:{checkSupport:function(a){return pa(a,"youtube")},init:function(a,b){var c=document.createElement("div");b.appendChild(c),h[y]=new window.YT.Player(c,{host:"https://www.youtube-nocookie.com",height:a.getAttribute("data-height")||"360",width:a.getAttribute("data-width")||"640",videoId:a.getAttribute("data-id"),playerVars:{controls:a.getAttribute("data-controls")||1,rel:0,playsinline:1}}),b.setAttribute("data-player",y),b.setAttribute("data-type","youtube"),y++},onPreload:function(){},onLoad:function(a){i.autoplayVideo&&h[a.getAttribute("data-player")].playVideo()},onLeave:function(a){1===h[a.getAttribute("data-player")].getPlayerState()&&h[a.getAttribute("data-player")].pauseVideo()},onCleanup:function(a){1===h[a.getAttribute("data-player")].getPlayerState()&&h[a.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(a){for(var b=Object.keys(a),c=b.length,d=Array(c);c--;)d[c]=[b[c],a[b[c]]];return d});var E=function(a){i=C(a),k||K();var b=document.querySelectorAll(i.selector);if(!b)throw new Error("Ups, I can't find the selector "+i.selector+" on this website.");Array.prototype.forEach.call(b,function(a){F(a)})},F=function(a){if(null!==document.querySelector("[data-type=\"youtube\"]")&&!x){if(null===document.getElementById("iframe_api")){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.id="iframe_api",b.src="https://www.youtube.com/iframe_api",c.parentNode.insertBefore(b,c)}-1===f.indexOf(a)&&f.push(a),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(f,function(a){I(a)}),x=!0}}else I(a)},G=function(a){return a.hasAttribute("data-group")?a.getAttribute("data-group"):"default"},H=function(a){return JSON.parse(JSON.stringify(a))},I=function(a){if(A=G(a),Object.prototype.hasOwnProperty.call(z,A)||(z[A]=H(g),L()),-1===z[A].gallery.indexOf(a)){if(z[A].gallery.push(a),z[A].elementsLength++,i.zoom&&a.querySelector("img")){var b=document.createElement("div");b.className="tobii-zoom__icon",b.innerHTML=i.zoomText,a.classList.add("tobii-zoom"),a.appendChild(b)}a.addEventListener("click",ba),M(a),va()&&A===B&&(ra(),sa())}else throw new Error("Ups, element already added.")},J=function(a){var b=G(a);if(-1===z[b].gallery.indexOf(a))throw new Error("Ups, I can't find a slide for the element "+a+".");else{var c=z[b].gallery.indexOf(a),d=z[b].sliderElements[c];if(va()&&b===B&&c===z[b].currentIndex)if(1===z[b].elementsLength)throw O(),new Error("Ups, I've closed. There are no slides more to show.");else 0===z[b].currentIndex?T():S();if(z[b].elementsLength--,i.zoom&&a.querySelector(".tobii-zoom__icon")){var e=a.querySelector(".tobii-zoom__icon");e.parentNode.classList.remove("tobii-zoom"),e.parentNode.removeChild(e)}a.removeEventListener("click",ba),d.parentNode.removeChild(d)}},K=function(){k=document.createElement("div"),k.setAttribute("role","dialog"),k.setAttribute("aria-hidden","true"),k.className="tobii",l=document.createElement("button"),l.className="tobii__btn tobii__btn--previous",l.setAttribute("type","button"),l.setAttribute("aria-label",i.navLabel[0]),l.innerHTML=i.navText[0],k.appendChild(l),m=document.createElement("button"),m.className="tobii__btn tobii__btn--next",m.setAttribute("type","button"),m.setAttribute("aria-label",i.navLabel[1]),m.innerHTML=i.navText[1],k.appendChild(m),n=document.createElement("button"),n.className="tobii__btn tobii__btn--close",n.setAttribute("type","button"),n.setAttribute("aria-label",i.closeLabel),n.innerHTML=i.closeText,k.appendChild(n),o=document.createElement("div"),o.className="tobii__counter",k.appendChild(o),document.body.appendChild(k)},L=function(){z[A].slider=document.createElement("div"),z[A].slider.className="tobii__slider",z[A].slider.setAttribute("aria-hidden","true"),k.appendChild(z[A].slider)},M=function(a){for(var b in D)if(Object.prototype.hasOwnProperty.call(D,b)&&D[b].checkSupport(a)){var c=document.createElement("div"),d=document.createElement("div");c.className="tobii__slide",c.style.position="absolute",c.style.left=100*z[A].x+"%",c.setAttribute("aria-hidden","true"),D[b].init(a,d),c.appendChild(d),z[A].slider.appendChild(c),z[A].sliderElements.push(c),++z[A].x;break}},N=function(a){if(B=null===B?A:B,va())throw new Error("Ups, I'm aleady open.");if(!va()&&(a||(a=0),-1===a||a>=z[B].elementsLength))throw new Error("Ups, I can't find slide "+a+".");i.hideScrollbar&&(document.documentElement.classList.add("tobii-is-open"),document.body.classList.add("tobii-is-open")),ra(),i.close||(n.disabled=!1,n.setAttribute("aria-hidden","true")),t=document.activeElement,z[B].currentIndex=a,$(),na(),Q(z[B].currentIndex),z[B].slider.setAttribute("aria-hidden","false"),k.setAttribute("aria-hidden","false"),sa(),P(z[B].currentIndex+1),P(z[B].currentIndex-1),setTimeout(function(){z[B].slider.classList.add("tobii__slider--animate")},1e3)},O=function(){if(!va())throw new Error("Ups, I'm already closed.");i.hideScrollbar&&(document.documentElement.classList.remove("tobii-is-open"),document.body.classList.remove("tobii-is-open")),oa(),t.focus(),V(z[B].currentIndex),W(z[B].currentIndex),k.setAttribute("aria-hidden","true"),z[B].slider.setAttribute("aria-hidden","true"),z[B].currentIndex=0,z[B].slider.classList.remove("tobii__slider--animate")},P=function(a){if(void 0!==z[B].sliderElements[a]){var b=z[B].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");D[c].onPreload(b)}},Q=function(a){if(void 0!==z[B].sliderElements[a]){var b=z[B].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");z[B].sliderElements[a].classList.add("tobii__slide--is-active"),z[B].sliderElements[a].setAttribute("aria-hidden","false"),D[c].onLoad(b)}},R=function(a){var b=z[B].currentIndex;if(!va())throw new Error("Ups, I'm closed.");if(va()){if(!a&&0!==a)throw new Error("Ups, no slide specified.");if(a===z[B].currentIndex)throw new Error("Ups, slide "+a+" is already selected.");if(-1===a||a>=z[B].elementsLength)throw new Error("Ups, I can't find slide "+a+".")}z[B].currentIndex=a,V(b),Q(a),a<b&&(sa("left"),W(b),P(a-1)),a>b&&(sa("right"),W(b),P(a+1))},S=function(){if(!va())throw new Error("Ups, I'm closed.");0<z[B].currentIndex&&(V(z[B].currentIndex),Q(--z[B].currentIndex),sa("left"),W(z[B].currentIndex+1),P(z[B].currentIndex-1)),k.dispatchEvent(new Event("tobii-prev"))},T=function(){if(!va())throw new Error("Ups, I'm closed.");z[B].currentIndex<z[B].elementsLength-1&&(V(z[B].currentIndex),Q(++z[B].currentIndex),sa("right"),W(z[B].currentIndex-1),P(z[B].currentIndex+1)),k.dispatchEvent(new Event("tobii-next"))},U=function(a){if(va())throw new Error("Ups, I'm open.");if(!a)throw new Error("Ups, no group specified.");if(a&&!Object.prototype.hasOwnProperty.call(z,a))throw new Error("Ups, I don't have a group called \""+a+"\".");B=a},V=function(a){if(void 0!==z[B].sliderElements[a]){var b=z[B].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");z[B].sliderElements[a].classList.remove("tobii__slide--is-active"),z[B].sliderElements[a].setAttribute("aria-hidden","true"),D[c].onLeave(b)}},W=function(a){if(void 0!==z[B].sliderElements[a]){var b=z[B].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");D[c].onCleanup(b)}},X=function(){B=null===B?A:B,u=-z[B].currentIndex*k.offsetWidth,z[B].slider.style.transform="translate3d("+u+"px, 0, 0)",v=u},Y=function(){o.textContent=z[B].currentIndex+1+"/"+z[B].elementsLength},Z=function(a){i.nav?(l.setAttribute("aria-hidden","true"),l.disabled=!0,m.setAttribute("aria-hidden","true"),m.disabled=!0,1===z[B].elementsLength?i.close&&n.focus():0===z[B].currentIndex?(m.setAttribute("aria-hidden","false"),m.disabled=!1,m.focus()):z[B].currentIndex===z[B].elementsLength-1?(l.setAttribute("aria-hidden","false"),l.disabled=!1,l.focus()):(l.setAttribute("aria-hidden","false"),l.disabled=!1,m.setAttribute("aria-hidden","false"),m.disabled=!1,"left"===a?l.focus():m.focus())):i.close&&n.focus()},$=function(){p={startX:0,endX:0,startY:0,endY:0}},_=function(){var a=p.endX-p.startX,b=p.endY-p.startY,d=c(a),e=c(b);0<a&&d>i.threshold&&0<z[B].currentIndex?S():0>a&&d>i.threshold&&z[B].currentIndex!==z[B].elementsLength-1?T():0>b&&e>i.threshold&&i.swipeClose?O():X()},aa=function(){w||(w=!0,d.requestAnimationFrame(function(){X(),w=!1}))},ba=function(a){a.preventDefault(),B=G(this),N(z[B].gallery.indexOf(this))},ca=function(a){a.target===l?S():a.target===m?T():(a.target===n||a.target.classList.contains("tobii__slide")&&i.docClose)&&O(),a.stopPropagation()},da=function(){return Array.prototype.slice.call(k.querySelectorAll(".tobii__btn:not([disabled]), .tobii__slide--is-active + "+e.join(", .tobii__slide--is-active "))).filter(function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)})},ea=function(a){var b=da(),c=b.indexOf(document.activeElement);9===a.keyCode||"Tab"===a.code?a.shiftKey&&0===c?(b[b.length-1].focus(),a.preventDefault()):!a.shiftKey&&c===b.length-1&&(b[0].focus(),a.preventDefault()):27===a.keyCode||"Escape"===a.code?(a.preventDefault(),O()):37===a.keyCode||"ArrowLeft"===a.code?(a.preventDefault(),S()):(39===a.keyCode||"ArrowRight"===a.code)&&(a.preventDefault(),T())},fa=function(a){xa(a.target)||(a.stopPropagation(),s=!0,p.startX=a.touches[0].pageX,p.startY=a.touches[0].pageY,z[B].slider.classList.add("tobii__slider--is-dragging"))},ga=function(a){a.stopPropagation(),s&&(a.preventDefault(),p.endX=a.touches[0].pageX,p.endY=a.touches[0].pageY,ma())},ha=function(a){a.stopPropagation(),s=!1,z[B].slider.classList.remove("tobii__slider--is-dragging"),p.endX&&(q=!1,r=!1,_()),$()},ia=function(a){xa(a.target)||(a.preventDefault(),a.stopPropagation(),s=!0,p.startX=a.pageX,p.startY=a.pageY,z[B].slider.classList.add("tobii__slider--is-dragging"))},ja=function(a){a.preventDefault(),s&&(p.endX=a.pageX,p.endY=a.pageY,ma())},ka=function(){s=!1},la=function(a){a.stopPropagation(),s=!1,z[B].slider.classList.remove("tobii__slider--is-dragging"),p.endX&&(q=!1,r=!1,_()),$()},ma=function(){var a=Math.round;0<c(p.startX-p.endX)&&!r&&1<z[B].elementsLength?(z[B].slider.style.transform="translate3d("+(v-a(p.startX-p.endX))+"px, 0, 0)",q=!0,r=!1):0<c(p.startY-p.endY)&&!q&&i.swipeClose&&(z[B].slider.style.transform="translate3d("+v+"px, -"+a(p.startY-p.endY)+"px, 0)",q=!1,r=!0)},na=function(){i.keyboard&&d.addEventListener("keydown",ea),d.addEventListener("resize",aa),k.addEventListener("click",ca),i.draggable&&(wa()&&(k.addEventListener("touchstart",fa),k.addEventListener("touchmove",ga),k.addEventListener("touchend",ha)),k.addEventListener("mousedown",ia),k.addEventListener("mouseup",la),k.addEventListener("mousemove",ja),k.addEventListener("contextmenu",ka))},oa=function(){i.keyboard&&d.removeEventListener("keydown",ea),d.removeEventListener("resize",aa),k.removeEventListener("click",ca),i.draggable&&(wa()&&(k.removeEventListener("touchstart",fa),k.removeEventListener("touchmove",ga),k.removeEventListener("touchend",ha)),k.removeEventListener("mousedown",ia),k.removeEventListener("mouseup",la),k.removeEventListener("mousemove",ja),k.removeEventListener("contextmenu",ka))},pa=function(a,b){return a.getAttribute("data-type")===b},qa=function(a){var b=a.querySelectorAll("src");b&&Array.prototype.forEach.call(b,function(a){a.setAttribute("src","")})},ra=function(){(i.draggable&&i.swipeClose&&!z[B].slider.classList.contains("tobii__slider--is-draggable")||i.draggable&&1<z[B].elementsLength&&!z[B].slider.classList.contains("tobii__slider--is-draggable"))&&z[B].slider.classList.add("tobii__slider--is-draggable"),!i.nav||1===z[B].elementsLength||"auto"===i.nav&&wa()?(l.setAttribute("aria-hidden","true"),l.disabled=!0,m.setAttribute("aria-hidden","true"),m.disabled=!0):(l.setAttribute("aria-hidden","false"),l.disabled=!1,m.setAttribute("aria-hidden","false"),m.disabled=!1),i.counter&&1!==z[B].elementsLength?o.setAttribute("aria-hidden","false"):o.setAttribute("aria-hidden","true")},sa=function(a){X(),Y(),Z(a)},ta=function(){va()&&O();var a=Object.entries(z);Array.prototype.forEach.call(a,function(a){var b=a[1].gallery;Array.prototype.forEach.call(b,function(a){J(a)})}),z={},A=B=null,j=0},ua=function(){ta(),k.parentNode.removeChild(k)},va=function(){return"false"===k.getAttribute("aria-hidden")},wa=function(){return"ontouchstart"in window},xa=function(a){return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(a.nodeName)||a===l||a===m||a===n},ya=function(){return z[B].currentIndex},za=function(){return z[B].elementsLength},Aa=function(){return null===B?A:B};return E(b),a.open=N,a.previous=S,a.next=T,a.close=O,a.add=F,a.remove=J,a.reset=ta,a.destroy=ua,a.isOpen=va,a.slidesIndex=ya,a.select=R,a.slidesCount=za,a.selectGroup=U,a.currentGroup=Aa,a}return a});
