(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.Tobii=b())})(this,function(){'use strict';return function(a){var b=Math.abs,c=window,d=["a[href]:not([tabindex^=\"-\"]):not([inert])","area[href]:not([tabindex^=\"-\"]):not([inert])","input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])","iframe:not([tabindex^=\"-\"]):not([inert])","audio:not([tabindex^=\"-\"]):not([inert])","video:not([tabindex^=\"-\"]):not([inert])","[contenteditable]:not([tabindex^=\"-\"]):not([inert])","[tabindex]:not([tabindex^=\"-\"]):not([inert])"],e=[],f={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},g=[],h={},i=0,j=null,k=null,l=null,m=null,n=null,o={},p=!1,q=!1,r=!1,s=null,t=null,u=null,v=!1,w=!1,x=0,y={},z=null,A=null,B=function(a){var b={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:["<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M14 18l-6-6 6-6\"/></svg>","<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M10 6l6 6-6 6\"/></svg>"],navLabel:["Previous image","Next image"],close:!0,closeText:"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewbox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M6 6l12 12M6 18L18 6\"/></svg>",closeLabel:"Close lightbox",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download image",keyboard:!0,zoom:!0,zoomText:"<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" aria-hidden=\"true\" focusable=\"false\"><path d=\"M21 16v5h-5\"/><path d=\"M8 21H3v-5\"/><path d=\"M16 3h5v5\"/><path d=\"M3 8V3h5\"/></svg>",docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1};return a&&Object.keys(a).forEach(function(c){b[c]=a[c]}),b},C={image:{checkSupport:function(a){return!a.hasAttribute("data-type")&&a.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)(\?.*)?$/i)},init:function(a,b){var c=document.createElement("figure"),d=document.createElement("figcaption"),e=document.createElement("img"),f=a.querySelector("img"),g=document.createElement("div");c.style.opacity="0",f&&(e.alt=f.alt||""),e.setAttribute("src",""),e.setAttribute("data-src",a.href),c.appendChild(e),h.captions&&("self"===h.captionsSelector&&a.getAttribute(h.captionAttribute)?d.textContent=a.getAttribute(h.captionAttribute):"img"===h.captionsSelector&&f&&f.getAttribute(h.captionAttribute)&&(d.textContent=f.getAttribute(h.captionAttribute)),d.textContent&&(d.id="tobii-figcaption-"+i,c.appendChild(d),e.setAttribute("aria-labelledby",d.id),++i)),b.appendChild(c),g.className="tobii-loader",g.setAttribute("role","progressbar"),g.setAttribute("aria-label",h.loadingIndicatorLabel),b.appendChild(g),b.setAttribute("data-type","image")},onPreload:function(a){C.image.onLoad(a)},onLoad:function(a){var b=a.querySelector("img");if(b.hasAttribute("data-src")){var c=a.querySelector("figure"),d=a.querySelector(".tobii-loader");b.onload=function(){a.removeChild(d),c.style.opacity="1"},b.setAttribute("src",b.getAttribute("data-src")),b.removeAttribute("data-src")}},onLeave:function(){},onCleanup:function(){}},html:{checkSupport:function(a){return la(a,"html")},init:function(a,b){var c=a.hasAttribute("href")?a.getAttribute("href"):a.getAttribute("data-target"),d=document.querySelector(c);if(!d)throw new Error("Ups, I can't find the target "+c+".");b.appendChild(d),b.setAttribute("data-type","html")},onPreload:function(){},onLoad:function(a){var b=a.querySelector("video");b&&(b.hasAttribute("data-time")&&0<b.readyState&&(b.currentTime=b.getAttribute("data-time")),h.autoplayVideo&&b.play())},onLeave:function(a){var b=a.querySelector("video");b&&(!b.paused&&b.pause(),0<b.readyState&&b.setAttribute("data-time",b.currentTime))},onCleanup:function(a){var b=a.querySelector("video");if(b&&0<b.readyState&&3>b.readyState&&b.duration!==b.currentTime){var c=b.cloneNode(!0);ma(b),b.load(),b.parentNode.removeChild(b),a.appendChild(c)}}},iframe:{checkSupport:function(a){return la(a,"iframe")},init:function(a,b){var c=document.createElement("iframe"),d=a.hasAttribute("href")?a.getAttribute("href"):a.getAttribute("data-target");c.setAttribute("frameborder","0"),c.setAttribute("src",""),c.setAttribute("data-src",d),a.getAttribute("data-width")&&(c.style.maxWidth=a.getAttribute("data-width")+"px"),a.getAttribute("data-height")&&(c.style.maxHeight=a.getAttribute("data-height")+"px"),b.appendChild(c),b.setAttribute("data-type","iframe")},onPreload:function(){},onLoad:function(a){var b=a.querySelector("iframe");b.setAttribute("src",b.getAttribute("data-src"))},onLeave:function(){},onCleanup:function(){}},youtube:{checkSupport:function(a){return la(a,"youtube")},init:function(a,b){var c=document.createElement("div");b.appendChild(c),g[x]=new window.YT.Player(c,{host:"https://www.youtube-nocookie.com",height:a.getAttribute("data-height")||"360",width:a.getAttribute("data-width")||"640",videoId:a.getAttribute("data-id"),playerVars:{controls:a.getAttribute("data-controls")||1,rel:0,playsinline:1}}),b.setAttribute("data-player",x),b.setAttribute("data-type","youtube"),x++},onPreload:function(){},onLoad:function(a){h.autoplayVideo&&g[a.getAttribute("data-player")].playVideo()},onLeave:function(a){1===g[a.getAttribute("data-player")].getPlayerState()&&g[a.getAttribute("data-player")].pauseVideo()},onCleanup:function(a){1===g[a.getAttribute("data-player")].getPlayerState()&&g[a.getAttribute("data-player")].pauseVideo()}}};Object.entries||(Object.entries=function(a){for(var b=Object.keys(a),c=b.length,d=Array(c);c--;)d[c]=[b[c],a[b[c]]];return d});var D=function(a){h=B(a),j||J();var b=document.querySelectorAll(h.selector);if(!b)throw new Error("Ups, I can't find the selector "+h.selector+".");Array.prototype.forEach.call(b,function(a){E(a)})},E=function(a,b){if(null!==document.querySelector("[data-type=\"youtube\"]")&&!w){if(null===document.getElementById("iframe_api")){var c=document.createElement("script"),d=document.getElementsByTagName("script")[0];c.id="iframe_api",c.src="https://www.youtube.com/iframe_api",d.parentNode.insertBefore(c,d)}-1===e.indexOf(a)&&e.push(a),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(e,function(a){H(a,b)}),w=!0}}else H(a,b)},F=function(a){return a.hasAttribute("data-group")?a.getAttribute("data-group"):"default"},G=function(a){return JSON.parse(JSON.stringify(a))},H=function(a,b){if(z=F(a),Object.prototype.hasOwnProperty.call(y,z)||(y[z]=G(f),K()),-1===y[z].gallery.indexOf(a)){if(y[z].gallery.push(a),y[z].elementsLength++,h.zoom&&a.querySelector("img")){var c=document.createElement("div");c.className="tobii-zoom__icon",c.innerHTML=h.zoomText,a.classList.add("tobii-zoom"),a.appendChild(c)}a.addEventListener("click",$),L(a),sa()&&z===A&&(na(),pa()),b&&b.call(this)}else throw new Error("Ups, element already added to the lightbox.")},I=function(a,b){var c=F(a);if(-1===y[c].gallery.indexOf(a));else{var d=y[c].gallery.indexOf(a),e=y[c].sliderElements[d];if(y[c].elementsLength--,h.zoom&&a.querySelector(".tobii-zoom__icon")){var f=a.querySelector(".tobii-zoom__icon");f.parentNode.classList.remove("tobii-zoom"),f.parentNode.removeChild(f)}a.removeEventListener("click",$),e.parentNode.removeChild(e),sa()&&c===A&&(na(),pa()),b&&b.call(this)}},J=function(){j=document.createElement("div"),j.setAttribute("role","dialog"),j.setAttribute("aria-hidden","true"),j.className="tobii",k=document.createElement("button"),k.className="tobii__prev",k.setAttribute("type","button"),k.setAttribute("aria-label",h.navLabel[0]),k.innerHTML=h.navText[0],j.appendChild(k),l=document.createElement("button"),l.className="tobii__next",l.setAttribute("type","button"),l.setAttribute("aria-label",h.navLabel[1]),l.innerHTML=h.navText[1],j.appendChild(l),m=document.createElement("button"),m.className="tobii__close",m.setAttribute("type","button"),m.setAttribute("aria-label",h.closeLabel),m.innerHTML=h.closeText,j.appendChild(m),n=document.createElement("div"),n.className="tobii__counter",j.appendChild(n),document.body.appendChild(j)},K=function(){y[z].slider=document.createElement("div"),y[z].slider.className="tobii__slider",j.appendChild(y[z].slider)},L=function(a){for(var b in C)if(Object.prototype.hasOwnProperty.call(C,b)&&C[b].checkSupport(a)){var c=document.createElement("div"),d=document.createElement("div");c.className="tobii__slider-slide",c.style.position="absolute",c.style.left=100*y[z].x+"%",C[b].init(a,d),c.appendChild(d),y[z].slider.appendChild(c),y[z].sliderElements.push(c),++y[z].x;break}},M=function(a,b){if(A=null===A?z:A,sa()||a||(a=0),sa()){if(!a)throw new Error("Ups, Tobii is aleady open.");if(a===y[A].currentIndex)throw new Error("Ups, slide "+a+" is already selected.")}if(-1===a||a>=y[A].elementsLength)throw new Error("Ups, I can't find slide "+a+".");h.hideScrollbar&&(document.documentElement.classList.add("tobii-is-open"),document.body.classList.add("tobii-is-open")),na(),h.close||(m.disabled=!1,m.setAttribute("aria-hidden","true")),s=document.activeElement,y[A].currentIndex=a,X(),ja(),P(y[A].currentIndex),j.setAttribute("aria-hidden","false"),pa(),O(y[A].currentIndex+1),O(y[A].currentIndex-1),setTimeout(function(){y[A].slider.classList.add("tobii__slider--animate")},1e3),b&&b.call(this)},N=function(a){if(!sa())throw new Error("Tobii is already closed.");h.hideScrollbar&&(document.documentElement.classList.remove("tobii-is-open"),document.body.classList.remove("tobii-is-open")),ka(),s.focus();var b=y[A].sliderElements[y[A].currentIndex].querySelector("[data-type]"),c=b.getAttribute("data-type");C[c].onLeave(b),C[c].onCleanup(b),j.setAttribute("aria-hidden","true"),y[A].currentIndex=0,y[A].slider.classList.remove("tobii__slider--animate"),a&&a.call(this)},O=function(a){if(void 0!==y[A].sliderElements[a]){var b=y[A].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");C[c].onPreload(b)}},P=function(a){if(void 0!==y[A].sliderElements[a]){var b=y[A].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");y[A].sliderElements[a].classList.add("tobii__slider-slide--is-active"),C[c].onLoad(b)}},Q=function(a){0<y[A].currentIndex&&(S(y[A].currentIndex),P(--y[A].currentIndex),pa("left"),T(y[A].currentIndex+1),O(y[A].currentIndex-1),a&&a.call(this))},R=function(a){y[A].currentIndex<y[A].elementsLength-1&&(S(y[A].currentIndex),P(++y[A].currentIndex),pa("right"),T(y[A].currentIndex-1),O(y[A].currentIndex+1),a&&a.call(this))},S=function(a){if(void 0!==y[A].sliderElements[a]){var b=y[A].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");y[A].sliderElements[a].classList.remove("tobii__slider-slide--is-active"),C[c].onLeave(b)}},T=function(a){if(void 0!==y[A].sliderElements[a]){var b=y[A].sliderElements[a].querySelector("[data-type]"),c=b.getAttribute("data-type");C[c].onCleanup(b)}},U=function(){A=null===A?z:A,t=-y[A].currentIndex*j.offsetWidth,y[A].slider.style.transform="translate3d("+t+"px, 0, 0)",u=t},V=function(){n.textContent=y[A].currentIndex+1+"/"+y[A].elementsLength},W=function(a){h.nav?(k.disabled=!1,l.disabled=!1,"left"===a?k.focus():l.focus(),1===y[A].elementsLength?(k.disabled=!0,l.disabled=!0,h.close&&m.focus()):(0===y[A].currentIndex&&(k.disabled=!0,l.focus()),y[A].currentIndex===y[A].elementsLength-1&&(l.disabled=!0,k.focus()))):h.close&&m.focus()},X=function(){o={startX:0,endX:0,startY:0,endY:0}},Y=function(){var a=o.endX-o.startX,c=o.endY-o.startY,d=b(a),e=b(c);0<a&&d>h.threshold&&0<y[A].currentIndex?Q():0>a&&d>h.threshold&&y[A].currentIndex!==y[A].elementsLength-1?R():0>c&&e>h.threshold&&h.swipeClose?N():U()},Z=function(){v||(v=!0,c.requestAnimationFrame(function(){U(),v=!1}))},$=function(a){a.preventDefault(),A=F(this),M(y[A].gallery.indexOf(this))},_=function(a){a.target===k?Q():a.target===l?R():(a.target===m||a.target.classList.contains("tobii__slider-slide")&&h.docClose)&&N(),a.stopPropagation()},aa=function(){return Array.prototype.slice.call(j.querySelectorAll(".tobii__slider-slide--is-active "+d.join(","),".tobii__close","tobii__prev",".tobii__next")).filter(function(a){return!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length)})},ba=function(a){var b=aa(),c=b.indexOf(document.activeElement);9===a.keyCode||"Tab"===a.code?a.shiftKey&&0===c?(b[b.length-1].focus(),a.preventDefault()):!a.shiftKey&&c===b.length-1&&(b[0].focus(),a.preventDefault()):27===a.keyCode||"Escape"===a.code?(a.preventDefault(),N()):37===a.keyCode||"ArrowLeft"===a.code?(a.preventDefault(),Q()):(39===a.keyCode||"ArrowRight"===a.code)&&(a.preventDefault(),R())},ca=function(a){ua(a.target)||(a.stopPropagation(),r=!0,o.startX=a.touches[0].pageX,o.startY=a.touches[0].pageY,y[A].slider.classList.add("tobii__slider--is-dragging"))},da=function(a){a.stopPropagation(),r&&(a.preventDefault(),o.endX=a.touches[0].pageX,o.endY=a.touches[0].pageY,ia())},ea=function(a){a.stopPropagation(),r=!1,y[A].slider.classList.remove("tobii__slider--is-dragging"),o.endX&&(p=!1,q=!1,Y()),X()},fa=function(a){ua(a.target)||(a.preventDefault(),a.stopPropagation(),r=!0,o.startX=a.pageX,o.startY=a.pageY,y[A].slider.classList.add("tobii__slider--is-dragging"))},ga=function(a){a.preventDefault(),r&&(o.endX=a.pageX,o.endY=a.pageY,ia())},ha=function(a){a.stopPropagation(),r=!1,y[A].slider.classList.remove("tobii__slider--is-dragging"),o.endX&&(p=!1,q=!1,Y()),X()},ia=function(){var a=Math.round;0<b(o.startX-o.endX)&&!q&&h.swipeClose?(y[A].slider.style.transform="translate3d("+(u-a(o.startX-o.endX))+"px, 0, 0)",p=!0,q=!1):0<b(o.startY-o.endY)&&!p&&(y[A].slider.style.transform="translate3d("+u+"px, -"+a(o.startY-o.endY)+"px, 0)",p=!1,q=!0)},ja=function(){h.keyboard&&c.addEventListener("keydown",ba),c.addEventListener("resize",Z),j.addEventListener("click",_),h.draggable&&(ta()&&(j.addEventListener("touchstart",ca),j.addEventListener("touchmove",da),j.addEventListener("touchend",ea)),j.addEventListener("mousedown",fa),j.addEventListener("mouseup",ha),j.addEventListener("mousemove",ga))},ka=function(){h.keyboard&&c.removeEventListener("keydown",ba),c.removeEventListener("resize",Z),j.removeEventListener("click",_),h.draggable&&(ta()&&(j.removeEventListener("touchstart",ca),j.removeEventListener("touchmove",da),j.removeEventListener("touchend",ea)),j.removeEventListener("mousedown",fa),j.removeEventListener("mouseup",ha),j.removeEventListener("mousemove",ga))},la=function(a,b){return a.getAttribute("data-type")===b},ma=function(a){var b=a.querySelectorAll("src");b&&Array.prototype.forEach.call(b,function(a){a.setAttribute("src","")})},na=function(){h.draggable&&1<y[A].elementsLength&&!y[A].slider.classList.contains("tobii__slider--is-draggable")&&y[A].slider.classList.add("tobii__slider--is-draggable"),!h.nav||1===y[A].elementsLength||"auto"===h.nav&&ta()?(k.setAttribute("aria-hidden","true"),l.setAttribute("aria-hidden","true")):(k.setAttribute("aria-hidden","false"),l.setAttribute("aria-hidden","false")),h.counter&&1!==y[A].elementsLength?n.setAttribute("aria-hidden","false"):n.setAttribute("aria-hidden","true")},oa=function(){for(var a in y)Object.prototype.hasOwnProperty.call(y,a)&&(y[a].slider.style.display=A===a?"block":"none")},pa=function(a){oa(),U(),V(),W(a)},qa=function(a){sa()&&N();var b=Object.entries(y);Array.prototype.forEach.call(b,function(a){var b=a[1].gallery;Array.prototype.forEach.call(b,function(a){I(a)})}),y={},z=A=null,i=0,a&&a.call(this)},ra=function(a){qa(),j.parentNode.removeChild(j),a&&a.call(this)},sa=function(){return"false"===j.getAttribute("aria-hidden")},ta=function(){return"ontouchstart"in window},ua=function(a){return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(a.nodeName)||a===k||a===l||a===m||1===y[A].elementsLength},va=function(){return y[A].currentIndex},wa=function(){return null===A?z:A},xa=function(a){if(sa())throw new Error("Ups, I can't do this. Tobii is open.");if(a){if(a&&!Object.prototype.hasOwnProperty.call(y,a))throw new Error("Ups, I don't have a group called \""+a+"\".");A=a}};return D(a),{open:M,prev:Q,next:R,close:N,add:E,remove:I,reset:qa,destroy:ra,isOpen:sa,currentSlide:va,selectGroup:xa,currentGroup:wa}}});
